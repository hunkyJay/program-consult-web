<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<html lang="zxx">


<head>
    <title>Program Learning</title>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta name="description" content="">
    <meta name="keywords" content="">
    <meta name="author" content="">
    <meta name="MobileOptimized" content="320">
    <!--Start Style -->
    <link rel="stylesheet" type="text/css" th:href="@{/static/css/fonts.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/static/css/bootstrap.min.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/static/css/font-awesome.min.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/static/css/icofont.min.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/static/css/style.css}">
    <link rel="stylesheet" id="theme-change" type="text/css" href="">
</head>


<body>
<div class="loader">
    <div class="spinner">
        <img th:src="@{/static/picture/loader.gif}" alt="">
    </div>
</div>
<!-- Main Body -->
<div class="page-wrapper">
    <!-- Header Start -->
    <header class="header-wrapper main-header">
        <div class="header-inner-wrapper">
            <div class="logo-wrapper">

                <h3 style="color: white">Program Learning</h3>

            </div>
            <div class="header-right">
                <div class="serch-wrapper">
                    <form>
                        <input type="text" placeholder="Search Here...">
                    </form>
                    <a class="search-close" href="javascript:void(0);"><span class="icofont-close-line"></span></a>
                </div>
                <div class="header-left">
                    <div class="header-links">
                        <a href="javascript:void(0);" class="toggle-btn">
                            <span></span>
                        </a>
                    </div>
                </div>
                <div class="header-controls">

                    <div class="user-info-wrapper header-links">
                        <a href="javascript:void(0);" class="user-info">
                            <img th:src="@{'/static/picture/'+${mentor.img}}" alt="" class="user-img">
                            <div class="blink-animation">
                                <span class="blink-circle"></span>
                                <span class="main-circle"></span>
                            </div>
                        </a>
                        <div class="user-info-box">
                            <div class="drop-down-header">
                                <h4 th:text="${mentor.name}"> </h4>

                            </div>
                            <ul>
                                <li>
                                    <a th:href="@{/mentor/updateInfo}">
                                        <i class="far fa-edit"></i> Profile
                                    </a>
                                </li>
                                <li>
                                    <a href="/mentor/login">
                                        <i class="fas fa-sign-out-alt"></i> logout
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <!-- Sidebar Start -->
    <aside class="sidebar-wrapper">
        <div class="side-menu-wrap">
            <ul class="main-menu">
                <li>
                    <a th:href="@{/mentor/}">
                            <span class="icon-menu feather-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
                            </span>
                        <span class="menu-text">
                                Homepage
                            </span>
                    </a>
                </li>


                <li>
                    <a href="javascript:void(0);" class="active">
                            <span class="icon-menu feather-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-home"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
                            </span>
                        <span class="menu-text">
                                Appointments
                            </span>
                    </a>
                    <ul class="sub-menu">
                        <li>
                            <a th:href="@{/mentor/appointment}">
                                <span class="menu-text">
                                        Appointment List
                                    </span>
                            </a>
                        </li>
                        <li>
                            <a th:href="@{/mentor/accepted_appointment}">
                                <span class="menu-text">
                                        Accepted Appointments
                                    </span>
                            </a>
                        </li>
                    </ul>
                </li>

                <li>
                    <a th:href="@{/mentor/}">
                            <span class="icon-menu feather-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-users"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>
                            </span>
                        <span class="menu-text">
                                Profile
                            </span>
                    </a>
                </li>

                <li>
                    <a th:href="@{/mentor/appraise}">
                            <span class="icon-menu feather-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-send"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
                            </span>
                        <span class="menu-text">
                                Appraise
                            </span>
                    </a>
                </li>

                <li>
                    <a th:href="@{/mentor/}">
                            <span class="icon-menu feather-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-send"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
                            </span>
                        <span class="menu-text">
                                Notice
                            </span>
                    </a>
                </li>

            </ul>
        </div>
    </aside>
    <!-- Container Start -->
    <div class="page-wrapper">
        <div class="main-content">
            <div class="row">
                <!-- Styled Table Card-->
                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
                    <div class="card table-card">
                        <div class="card-header pb-0">
                            <h4>Accepted Appointments</h4>
                        </div>
                        <div class="card-body">
                            <div class="chart-holder">
                                <div class="table-responsive">
                                    <table class="table table-styled mb-0">
                                        <thead>
                                        <tr>
                                            <th>Appointment ID</th>
                                            <th>Student</th>
                                            <th>Appointment Time</th>
                                            <th>Meeting URL</th>
                                            <th>Status</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr th:each="appointment : ${appointments}">

                                            <td th:text="${appointment.appointment.appointmentId}"></td>
                                            <td th:text="${appointment.studentName}"></td>
                                            <td th:text="${appointment.appointment.appointmentTime}"></td>
                                            <td th:text="${appointment.appointment.meetingUrl}"></td>
                                            <td>
                                                <div th:switch="${appointment.appointment.status}">
                                                    <label th:case="0" class="mb-0 badge badge-primary" title="" data-original-title="Pending">wait-confirm</label>
                                                    <label th:case="1" class="mb-0 badge badge-important" title="" data-original-title="Pending">Accepted</label>
                                                    <label th:case="2" class="mb-0 badge badge-success" title="" data-original-title="Pending">Finished</label>
                                                    <label th:case="3" class="mb-0 badge badge-success" title="" data-original-title="Pending">Canceled by student</label>
                                                    <label th:case="4" class="mb-0 badge badge-dark" title="" data-original-title="Pending">Rejected</label>
                                                    <label th:case="5" class="mb-0 badge badge-success" title="" data-original-title="Pending">Finished</label>
                                                </div>
                                            </td>
                                            <td>
                                                <div th:switch="${appointment.appointment.status}">
                                                    <button th:case="0" id="accept" type="button" class="mb-0 badge badge-important" th:onclick="'javascript:acceptAppointment('+${appointment.appointment.appointmentId}+');'">Accept</button>
                                                    <button th:case="1" id="add_url" type="button" class="mb-0 badge badge-important" th:onclick="'javascript:addMeetingUrl('+${appointment.appointment.appointmentId}+');'">Add Meeting URL </button>
                                                </div>
                                            </td>
                                            <td>
                                                <div th:switch="${appointment.appointment.status}">
                                                    <button th:case="0" id="reject" type="button" class="mb-0 badge badge-danger" th:onclick="'javascript:rejectAppointment('+${appointment.appointment.appointmentId}+');'">Reject </button>
                                                    <button th:case="1" id="finish" type="button" class="mb-0 badge badge-danger" th:onclick="'javascript:finishAppointment('+${appointment.appointment.appointmentId}+');'">Finish Service</button>
                                                </div>
                                            </td>
                                        </tr>

                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Script Start -->
<script th:src="@{/static/js/jquery.min.js}"></script>
<script th:src="@{/static/js/popper.min.js}"></script>
<script th:src="@{/static/js/bootstrap.min.js}"></script>
<script th:src="@{/static/js/custom.js}"></script>
</body>

<script>

    function acceptAppointment(appointmentId){
        if (confirm("Are you sure to accept the appointment?")) {
            $.ajax({
                type:'get',
                url:"/mentor/confirm_appointment/",
                dataType:'json',
                data:{
                    appointmentId:appointmentId
                },
                async: false,
                success:function(){
                    window.location.href="/mentor/appointment/"
                },
            });
        }
    }

    function addMeetingUrl(appointmentId){
        var url = prompt("Please provide the meeting URL. ");
        if (url!=null && url!='') {
            $.ajax({
                type:'get',
                url:"/mentor/add_meetingurl/",
                dataType:'json',
                data:{
                    appointmentId:appointmentId,
                    url:url
                },
                async: false,
                success:function(){
                    window.location.href="/mentor/accepted_appointment/"
                },
            });
        }else {
            alert("Please enter a url.")
        }
    }

    function rejectAppointment(appointmentId){
        if (confirm("Are you sure to reject the appointment?")) {
            $.ajax({
                type:'get',
                url:"/mentor/refuse_appointment/",
                dataType:'json',
                data:{
                    appointmentId:appointmentId
                },
                async: false,
                success:function(){
                    window.location.href="/mentor/appointment/"
                },
            });
        }
    }

    function finishAppointment(appointmentId){
        if (confirm("Are you sure to end the appointment?")) {
            $.ajax({
                type:'get',
                url:"/mentor/complete_appointment/",
                dataType:'json',
                data:{
                    appointmentId:appointmentId
                },
                async: false,
                success:function(){
                    window.location.href="/mentor/accepted_appointment/"
                },
            });
        }
    }

</script>

</html>